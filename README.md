# WB_data_analisys

Реализовано два пайплайна

## Парвый пайплайн create_ref_tables()
Наверное скажу что здесь реализовано два пайплайна и оба связаны с справочными таблицами
- Первый создает справочные таблицы стран, и справоные таблицы для этой таблицы create_ref_tables_con()
  в итоге создается четыре таблицы contry, region, adminregion, income_level, lending_type(подробнее на рисунке)
- Второй создает справочные таблицы индикаторов, и справочныые таблицыы для этой таблицы create_ref_tables_ind()
  в итоге создается всего две таблицы indicator, source (в дальнейшем можно реализовать создание справочной таблицы
  topic - на данном этапе не понятно нужна ли она и она требует отдельного вниаминия дополнений при развертке ответа от api
  
Реализован logger

На вход каждый скрипт принимаает ".../config.json" содержащий необходимые данные для создания подключения к Postgresss
а также для работы c api
Есть функция валидации cfg которая делает работу скрипта слегка робастной к мелким ошибкам ввода
Архитктура основного пфйплайна условно extract->transsform->load
Реализована функция безопасного запроса к api а также универсальная функкция отработки пагинации
Этап трансформации немного провалился в моем понимании много хард кода
Загрузку в бд совершаю используя библитеку psycopg2 тк решил использовать динамические sql запросы к бд
