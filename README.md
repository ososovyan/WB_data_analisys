PS. Те замечния по коду и архитектуре скрипта пока не исправил и не дорааботал (можно не смотреть) начну деалть следом пока лишь собрал в кучу все добивл блок анализа данных он тоже лежит в репозитории в блоке буде на него ссыылкаа как и на визуализаию, также прописал методологию и струкктуру общего проекта
# WB_data_analisys
## Содержание
- [Цель и задачи](#title1)
- [Обзор проекта](#title2)
- [Сбор и подготовка данных](#title3)
- [Анализ данных](#title4)
## <a id="title1">Цель и задачи</a>
**Цель**

Целью данного исследования является комплексный анализ факторов, связанных с ожидаемой продолжительностью жизни населения в странах мира, а также выявление устойчивых социально-экономических, демографических и структурных различий между странами на разных этапах развития.

**Задачи**

- Парсинг данных API [World Bank](https://www.worldbank.org/ext/en/home)
- Обработка и нормализция полученных данных
- Организация хранилища для нормализоованных данных (облачная СУБД Postgresql [Supabase](https://supabase.com/))
- Подготовка витрин данных для BI системы
- Разведочный и структурный анализ (Python)
- Динамический анализ данных (Yandex Datalens)

**Итог**

Релизован ETL пайплайн, которые парсит данныые по API WB, обрабаытвает и нормализует их, и выгружает в развернутую облачную СУБД Postgres (Supabase). [Дашборд в Yandex Datalens](https://datalens.ru/l58lqbi9o6em5), который подключается к нашей CУБД, и берет за основу специально подготовеные витрины данных. И отдельно разведочный и структурный в Python
**Стек**

  
## <a id="title2">Обзор проекта</a>
## <a id="title3">Сбор и подготовка данных</a>
## <a id="title4">Анализ данных</a>

Первый пайплайн create_ref_tables()
Наверное скажу что здесь реализовано два пайплайна и оба связаны с справочными таблицами
- Первый создает справочные таблицы стран, и справоные таблицы для этой таблицы create_ref_tables_con()
  в итоге создается четыре таблицы contry, region, adminregion, income_level, lending_type(подробнее на рисунке)
- Второй создает справочные таблицы индикаторов, и справочныые таблицыы для этой таблицы create_ref_tables_ind()
  в итоге создается всего две таблицы indicator, source (в дальнейшем можно реализовать создание справочной таблицы
  topic - на данном этапе не понятно нужна ли она и она требует отдельного вниаминия дополнений при развертке ответа от api
  
Реализован logger

На вход каждый скрипт принимаает ".../config.json" содержащий необходимые данные для создания подключения к Postgresss
а также для работы c api
Есть функция валидации cfg которая делает работу скрипта слегка робастной к мелким ошибкам ввода
Архитктура основного пфйплайна условно extract->transsform->load
Реализована функция безопасного запроса к api а также универсальная функкция отработки пагинации
Этап трансформации немного провалился в моем понимании много хард кода
Загрузку в бд совершаю используя библитеку psycopg2 тк решил использовать динамические sql запросы к бд
очень наприятно что при запросе к странам id страны iso3, а вот когда делать основной запрос то он решает теперь сдеелать его iso2 добаввил хардкода
![Схема бд](https://github.com/ososovyan/WB_data_analisys/blob/main/Scema_bd.png)

