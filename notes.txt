P/S Это не только вопросы, но и заметки для себя чтобы я хотел видеть
также интересно как лучше сделать тот или иной шаг в контексте того что я сделал
1. Логгер со stage
2. Углубиться больше в API: реализовать экспоненциальный delay(не сложно но нужно ли)
    ассинхронный запрос быть может
3. Сделать safe_request упрощенным может сделать еще более общую функцию,
    может создать универсальный ретраер
4. Расширить cfg и возможности применения к другим endpoint ".../unit/..." например
    вроде так можно но функция не предполагает (вообще с учетом того что в итоге есть отделаьный
    пайплайн по выгрузке справочных таблиц возможно это не надо)
5. Применить ООП быть может для и работать с методами класса где-то???
6. Не всегда задумываюсь с позиции памяти и длительности и работаю обычными циклами порой
7. Может стоит выделять ключи вложенных структур автоматически на этапе обработки
8. функция create_table() может сделать и организоваать ретрай логику можэет быть такое что при создании
    таблицы стран нет таблицы регионов (в нашем скриипте для создания справочных таблиц все идет по порядку
    и такого быть не может но все же, через try except выловить ошибку и сделать рекурентный вызов функции
    однако следующий вопрос можно ли делать рекурентный выызов во время сессии или я в excrpt
    делаю cur.close() и только потом делаю рекурсию и создаю все необходимые 4 справочные таблицы
    и после этого делаю вызов с параметрами на которых произошел откат еще раз
    есть шанс утонуть в рекурсии ахах
9. также я пока никак не отрабатываю возможные ошибки подключения к бд пока
10. При создании таблицы может сразу стоит делать все ее fk индексами
11. используем множественную вставку executemany()
    встречал что еще можно по другому метод COPY FROM STDIN потоковая загрузка строк без SQL-парсинга
    Однако как я понял что тогда мы не сможем делать UPSERT, не то чтобы он прям нужен
    как сделать лучше
12. Я не отрабатываю случай если вдруг таблица сущетсвует но у нее меньшее кол-во столбцов подраазумевая
    что все будет создаваться по одному шаблону pd.df который не будет меняться
    не доконца корректо но нужно ли сделать проверку или отработать случай
13. Заметил что типы плывут немного буду отрабатывать
14. Файловая система и ее организация хромает
15. Я хитрю при выгрузке данных для подключения из кфг, лениво пока дописывать валидацию для этого
    при этом нужно отработать возможные ошибки при подключении к бд
16. Трансформация костыльная, наверное все таки хочу автоматизированно создавать выделять вложенные структуры
17. Пока не до конца понимаю как отработать столбец topics, исключу его пока просто
    в целом пока не вижу нужен ли он в анализе дальше будет source оставлю
18. Безумно медленная закачка в sql
